<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì‹ ì˜ ì† - ì‚¬ë ¹ë¶€ í†µí•©ë³¸</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background-color: #0c0c0c; color: #f2c94c; font-family: 'Malgun Gothic', sans-serif; text-align: center; padding: 20px; margin: 0; }
        h1 { color: #f2c94c; font-size: 2.5rem; margin-top: 30px; font-weight: bold; cursor: pointer; }
        .target-box { color: #FFF; font-size: 1.1rem; margin-bottom: 20px; background: #1a1a1a; padding: 8px 15px; border-radius: 10px; display: inline-block; border: 2px solid #f2c94c; }
        .btn-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; max-width: 400px; margin: 0 auto 15px auto; }
        button { border: none; border-radius: 8px; cursor: pointer; font-size: 17px; font-weight: bold; transition: 0.2s; }
        .btn-main { width: 100%; height: 55px; background-color: #d4a017; color: black; margin-bottom: 5px; }
        .btn-sub { width: 48.5%; height: 50px; background-color: #262626; color: white; border: 1px solid #333; }
        .btn-menu { width: 100%; height: 50px; background-color: #1a1a1a; color: #f2c94c; border: 2px dashed #f2c94c; margin-top: 10px; }
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; overflow-y: auto; padding: 20px; }
        .modal-content { background: #1a1a1a; width: 95%; max-width: 380px; margin: 0 auto; padding: 20px; border: 2px solid #f2c94c; border-radius: 15px; text-align: center; }
        #console { width: 100%; height: 250px; padding: 15px; background: #1a1a1a; color: #f2c94c; border: 2px solid #333; border-radius: 12px; margin: 15px auto; text-align: left; overflow-y: auto; white-space: pre-wrap; box-sizing: border-box; font-size: 18px; font-weight: bold; }
        .admin-input { width: 100%; height: 45px; margin: 15px 0; background: #000; color: #fff; border: 1px solid #f2c94c; text-align: center; font-size: 20px; letter-spacing: 5px; }
        textarea { width: 100%; height: 100px; background: #000; color: #0f0; border: 1px solid #0f0; padding: 10px; box-sizing: border-box; font-size: 16px; margin-bottom: 10px; }
    </style>
</head>
<body>
    <h1 onclick="location.reload()">ì‹ ì˜ ì†</h1>
    <div class="target-box" id="current-strategy">ğŸ¯ ì „ëµ ë¶„ì„ ëŒ€ê¸° ì¤‘...</div>
    
    <div class="btn-container">
        <button class="btn-main" onclick="process('5')">5ì¡°í•© ìƒì„± (AC 9-10)</button>
        <button class="btn-main" onclick="process('10')">10ì¡°í•© ìƒì„± (íŒ¨í„´ ë¶„ì„)</button>
        <button class="btn-sub" onclick="showModal('storage')">ë³´ê´€í•¨</button>
        <button class="btn-sub" onclick="clearAll()">ì´ˆê¸°í™”</button>
        <button class="btn-menu" onclick="showModal('menu')">ğŸ“‹ ì „ëµ ë©”ë‰´íŒ (ì‚¬ë ¹ë¶€)</button>
    </div>

    <div id="console">â–¶ ì‚¬ì¥ë‹˜, ì‹œìŠ¤í…œ ì¬ì„¤ì • ì™„ë£Œ! ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”.</div>
    <div id="modal"><div class="modal-content" id="modal-inner"></div></div>

    <script>
        const firebaseConfig = { databaseURL: "https://lotto-euljiro-default-rtdb.firebaseio.com/" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        
        // ì´ˆê¸° ê¸°ë³¸ 18ìˆ˜ ì„¸íŒ…
        let cmd18Numbers = [1,4,9,11,16,18,23,25,27,31,33,35,38,40,41,42,44,45]; 
        let currentRound = "1206íšŒ";

        // ì„œë²„ì—ì„œ ì‹¤ì‹œê°„ ì „ëµ ìˆ˜ì‹ 
        db.ref('hq_strategy').on('value', (snap) => {
            const data = snap.val();
            if(data && data.nums) {
                cmd18Numbers = data.nums;
                currentRound = data.round;
                document.getElementById('current-strategy').innerText = `ğŸ¯ ${currentRound} [${cmd18Numbers.length}ìˆ˜] ì „ëµ ê°€ë™`;
            }
        });

        function getAC(arr) {
            let d = new Set();
            for(let i=0; i<6; i++) for(let j=i+1; j<6; j++) d.add(Math.abs(arr[i]-arr[j]));
            return d.size - 5;
        }

        function process(mode) {
            var box = document.getElementById('console');
            box.innerHTML = `â–¶ [${mode}ì¡°í•©] ìƒì„± ì¤‘...\n\n`;
            var gen = 0, safety = 0;
            while(gen < (mode=='5'?5:10) && safety < 5000) {
                safety++;
                var res = [];
                while(res.length < 6) {
                    var n = cmd18Numbers[Math.floor(Math.random() * cmd18Numbers.length)];
                    if(!res.includes(n)) res.push(n);
                }
                res.sort((a,b)=>a-b);
                if(mode=='5' && (getAC(res) < 9 || getAC(res) > 10)) continue;
                gen++;
                box.innerHTML += `(${gen}) ${res.map(n=>n<10?'0'+n:n).join('  ')}\n`;
            }
            box.scrollTop = box.scrollHeight;
        }

        function showModal(type) {
            var inner = document.getElementById('modal-inner');
            if(type == 'menu') {
                inner.innerHTML = `
                    <h2 style="color:#f2c94c">ğŸ“‹ ì „ëµ ë©”ë‰´íŒ</h2>
                    <p style="color:#888;">ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <input type="password" id="admin-pw" class="admin-input" placeholder="ë¹„ë°€ë²ˆí˜¸">
                    <button onclick="checkAdmin()" style="width:100%; height:45px; background:#d4a017; color:#000; border:none; font-weight:bold; border-radius:5px;">ì‚¬ë ¹ë¶€ ì ‘ì†</button>
                `;
            } else if(type == 'admin_panel') {
                inner.innerHTML = `
                    <h2 style="color:#f2c94c">ğŸ•¹ï¸ ì „ëµ ì‚¬ë ¹ë¶€</h2>
                    <p style="color:#fff;">18ìˆ˜ ì…ë ¥ (ì‰¼í‘œë¡œ êµ¬ë¶„)</p>
                    <textarea id="new-18">${cmd18Numbers.join(',')}</textarea>
                    <button onclick="sendStrategy()" style="width:100%; height:50px; background:#0f0; color:#000; font-weight:bold; border:none; border-radius:5px;">ğŸš€ ì „ëµ ì „ì†¡ (ì „ì²´ ë°°í¬)</button>
                `;
            }
            inner.innerHTML += '<button class="btn-sub" style="width:100%; margin-top:15px;" onclick="hideModal()">ë‹«ê¸°</button>';
            document.getElementById('modal').style.display = 'block';
        }

        function checkAdmin() {
            var pw = document.getElementById('admin-pw').value;
            if(pw === "1234") {
                showModal('admin_panel');
            } else {
                alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
            }
        }

        function sendStrategy() {
            const val = document.getElementById('new-18').value;
            const nums = val.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n));
            if(nums.length < 10) { alert("ìµœì†Œ 10ê°œ ì´ìƒ ì…ë ¥í•˜ì„¸ìš”."); return; }
            db.ref('hq_strategy').set({
                nums: nums,
                round: "1206íšŒ"
            }).then(() => {
                alert("ì „ëµ ë°°í¬ ì™„ë£Œ! ëª¨ë“  ì—°í•©êµ°ì—ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
                hideModal();
            });
        }

        function hideModal() { document.getElementById('modal').style.display = 'none'; }
        function clearAll() { if(confirm("ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) location.reload(); }
    </script>
</body>
</html>
